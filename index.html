<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ãšltimo Nivel</title>

  <style>
    :root{
      --bg:#06110d;
      --ink:#e7fff4;
      --muted:#b7d9c9;
      --line:#0e2f25;
      --accent:#31c48d;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(1200px 700px at 50% 35%, #0a2a1f 0%, var(--bg) 55%, #030a07 100%);
      color:var(--ink);
      display:flex; align-items:center; justify-content:center;
      padding:24px;
    }
    .card{
      width:min(720px,100%);
      background: rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius:20px;
      padding:22px;
      box-shadow: 0 20px 60px rgba(0,0,0,.45);
    }
    .topbar{
      display:flex; justify-content:space-between; align-items:center;
      font-size:12px; letter-spacing:.15em; text-transform:uppercase;
      color:var(--muted); margin-bottom:10px;
    }
    .dot{
      width:8px;height:8px;border-radius:999px;
      background:var(--accent);
      box-shadow:0 0 16px rgba(49,196,141,.6);
      display:inline-block;margin-right:8px;
    }
    h1{margin:0 0 10px;font-size:22px}
    p{margin:10px 0;line-height:1.55}
    .muted{color:var(--muted);font-size:14px}
    .btns{display:grid;gap:10px;margin-top:18px}
    button{
      border:1px solid var(--line);
      background: rgba(49,196,141,.15);
      color:var(--ink);
      padding:14px;
      border-radius:14px;
      font-weight:700;
      cursor:pointer;
    }
    button:hover{background: rgba(49,196,141,.25)}
    .input{
      width:100%;padding:12px;margin-top:12px;
      border-radius:12px;border:1px solid var(--line);
      background: rgba(0,0,0,.2);color:var(--ink);
    }
    .hint{margin-top:10px;font-size:13px;color:var(--muted)}
    .ok{color:#7CFCB2;font-weight:700}
    .no{color:#ffb3b3;font-weight:700}
  </style>
</head>

<body>

<!-- ðŸŽµ AUDIO -->
<audio id="bgm" loop preload="auto">
  <source src="music.mp3" type="audio/mpeg">
</audio>

<div class="card">
  <div class="topbar">
    <div><span class="dot"></span><span id="progress">1/1</span></div>
    <div id="tag">Ãºltimo nivel</div>
  </div>

  <h1 id="title"></h1>
  <div id="content"></div>
  <div class="btns" id="btns"></div>
</div>

<script>
/* ===== CONFIG ===== */
const NAME = "Mayra";

/* ===== MUSIC CONTROL ===== */
const bgm = document.getElementById("bgm");
let musicStarted = false;

function startMusic(){
  if (musicStarted) return;
  musicStarted = true;
  bgm.volume = 0;
  bgm.play().catch(()=>{});
  let v = 0;
  const fade = setInterval(()=>{
    v += 0.02;
    bgm.volume = Math.min(v, 0.25);
    if (v >= 0.25) clearInterval(fade);
  }, 120);
}

/* ===== GAME ===== */
let step = 0;
let code = "";

function el(id){return document.getElementById(id);}
function go(n){step=n;render();}

function normalize(s){
  return (s||"").toLowerCase()
    .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
    .replace(/[^\w\s]/g,"").trim();
}

const steps = [
{
  tag:"inicio",
  title:`Hola, ${NAME}.`,
  html:`
    <p class="muted">Verde oscuro. MÃºsica suave. Sin presiÃ³n.</p>
    <p>Te hice algo chiquito, pero pensado.</p>
    <p class="muted">Regla Ãºnica: disfruta.</p>
  `,
  buttons:[{
    text:"Empezar",
    action:()=>{ startMusic(); go(1); }
  }]
},
{
  tag:"1/6",
  title:"Pregunta 1",
  html:`<p>Si esto se siente bonito es porqueâ€¦</p>`,
  buttons:[
    {text:"Todo fluye", action:()=>go(2)},
    {text:"Me siento en paz", action:()=>go(2)},
    {text:"Las dos ðŸ˜Œ", action:()=>go(2)}
  ]
},
{
  tag:"2/6",
  title:"Pregunta 2",
  html:`<p>Contigo el tiempo se sienteâ€¦</p>`,
  buttons:[
    {text:"Ligero", action:()=>go(3)},
    {text:"Corto", action:()=>go(3)},
    {text:"Exacto", action:()=>go(3)}
  ]
},
{
  tag:"3/6",
  title:"Completa",
  html:`
    <p>Completa la frase:</p>
    <p><b>Se siente ____ contigo.</b></p>
    <input id="a3" class="input" placeholder="Escribe aquÃ­">
    <div id="fb" class="hint"></div>
  `,
  buttons:[{
    text:"Continuar",
    action:()=>{
      const v=normalize(el("a3").value);
      if(v.length>3) go(4);
      else el("fb").innerHTML="<span class='no'>Escribe algo bonito ðŸ˜Œ</span>";
    }
  }]
},
{
  tag:"4/6",
  title:"Pregunta 4",
  html:`<p>Esto no se siente forzado porqueâ€¦</p>`,
  buttons:[
    {text:"No hay expectativas", action:()=>go(5)},
    {text:"Todo se siente natural", action:()=>go(5)},
    {text:"Me gusta quedarme", action:()=>go(5)}
  ]
},
{
  tag:"5/6",
  title:"Ãšltima prueba",
  html:`<p>Elige el power-up correcto:</p>`,
  buttons:[
    {text:"MÃ¡s calma", action:()=>{code="AMOR";go(6)}},
    {text:"MÃ¡s nosotros", action:()=>{code="AMOR";go(6)}},
    {text:"MÃ¡s tÃº aquÃ­", action:()=>{code="AMOR";go(6)}}
  ]
},
{
  tag:"6/6",
  title:"Ãšltimo nivel",
  html:`
    <p class="muted">Ya fuera de juegoâ€¦</p>
    <p><b>${NAME}, Â¿quieres ser mi novia?</b></p>
  `,
  buttons:[
    {text:"SÃ­ ðŸ’š", action:()=>go(7)},
    {text:"Obvio sÃ­ ðŸ˜Œ", action:()=>go(7)}
  ]
},
{
  tag:"fin",
  title:"Checkpoint desbloqueado",
  html:`
    <p class="ok">Logro: Novios ðŸ’š</p>
    <p class="muted">Abrazo. Beso. Seguimos.</p>
  `,
  buttons:[{text:"Fin", action:()=>alert("ðŸ’š")}]
}
];

function render(){
  const s=steps[step];
  el("tag").textContent=s.tag;
  el("progress").textContent=`${step+1}/${steps.length}`;
  el("title").textContent=s.title;
  el("content").innerHTML=s.html;
  const btns=el("btns");btns.innerHTML="";
  (s.buttons||[]).forEach(b=>{
    const x=document.createElement("button");
    x.textContent=b.text;
    x.onclick=b.action||(()=>go(b.next));
    btns.appendChild(x);
  });
}
render();
</script>
</body>
</html>
